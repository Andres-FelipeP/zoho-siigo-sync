{% extends "base.html" %}

{% block title %}Código de Integración - DEKOTENDENCIA{% endblock %}
{% block header_icon %}bi bi-code-square{% endblock %}
{% block page_title %}Código de Integración{% endblock %}
{% block subtitle %}
<p class="card-text mt-2 mb-0 opacity-75">
    Siigo - Zoho CRM
</p>
{% endblock %}

{% block content %}
<div class="text-center py-4">
    <!-- Logo centrado -->
    <img src="/static/logo.png" alt="Logo LIENXO" class="img-fluid mb-4" style="max-height: 60px;">
    
    <!-- Título principal -->
    <h2 class="fw-bold mb-2">DEKOTENDENCIA</h2>
    
    <!-- Subtítulo -->
    <p class="text-muted mb-5">Código de Integración Siigo - Zoho CRM</p>
    
    <!-- Contenedor del código con borde punteado -->
    <div class="border border-custom-orange border-2 rounded-3 p-4 mb-4 mx-auto" style="max-width: 600px; border-style: dashed !important; border-color: #EA5437 !important;">
        <pre id="codigo" class="mb-0 text-center" style="font-family: inherit; white-space: pre-wrap; color: #EA5437;">Cargando...</pre>
    </div>
    
    <!-- Botón de copiar -->
    <button id="copyBtn" onclick="copiarCodigo()" class="btn btn-custom-orange px-4 py-2 mb-5">
        <i class="bi bi-clipboard me-2"></i>Copiar código
    </button>
    
    <!-- Footer del contenido -->
    <p class="text-muted">
        <small>© 2025 LIENXO. Todos los derechos reservados.</small>
    </p>
</div>
{% endblock %}

{% block scripts %}
<script>
    const params = new URLSearchParams(window.location.search);
    const code = params.get("code");
    const codeElement = document.getElementById("codigo");
    const copyBtn = document.getElementById("copyBtn");

    if (code) {
        codeElement.textContent = code;
    } else {
        codeElement.textContent = "No se encontró el código.";
    }

    function copiarCodigo() {
        const texto = codeElement.textContent;
        navigator.clipboard.writeText(texto)
            .then(() => {
                // Cambiar el botón temporalmente para mostrar éxito
                copyBtn.innerHTML = '<i class="bi bi-check-lg me-2"></i>Código copiado';
                copyBtn.classList.remove('btn-custom-orange');
                copyBtn.classList.add('btn-success');
                
                // Restaurar el botón después de 2 segundos
                setTimeout(() => {
                    copyBtn.innerHTML = '<i class="bi bi-clipboard me-2"></i>Copiar código';
                    copyBtn.classList.remove('btn-success');
                    copyBtn.classList.add('btn-custom-orange');
                }, 2000);
            });
    }
</script>
{% endblock %}